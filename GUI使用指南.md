# 🎨 GUI可视化界面使用指南

## 快速启动

### 方法1：双击启动（最简单）
```
双击运行: 启动GUI.bat
```

### 方法2：命令行启动
```powershell
python gui.py
```

---

## 界面布局

GUI界面分为4个主要区域：

### 1. 📝 Token管理区（顶部）
- **Token输入框** - 显示和编辑当前Token
- **💾 保存Token** - 保存Token到config.py（自动备份）
- **🔄 重新加载** - 从config.py重新加载Token
- **✓ 测试连接** - 验证Token是否有效

### 2. 🎯 功能按钮区（左侧）
包含所有操作按钮，分为5组：

#### 📊 数据操作
- **🔍 爬取所有数据** - 获取司机、车辆、排班信息
- **👤 查看司机列表** - 显示所有司机
- **🚗 查看车辆列表** - 显示所有车辆
- **📅 查看排班信息** - 显示排班表

#### 💾 导出数据
- **📄 导出为JSON** - 保存为JSON格式
- **📊 导出为Excel** - 保存为Excel文件（多工作表）
- **📂 打开数据目录** - 打开data文件夹

#### 🎯 调度操作
- **➕ 派工** - 分配订单给司机
- **➖ 退工** - 取消订单分配
- **🔄 订单转派** - 在司机间转移订单
- **📋 查看司机订单** - 查询司机的订单

#### ⚡ 批量操作
- **📦 批量派工** - 一次派发多个订单
- **🗑️ 批量退工** - 一次取消多个订单

#### ⚙️ 系统
- **📜 查看日志** - 显示automation.log内容
- **🗑️ 清空输出** - 清空输出区

### 3. 📺 输出显示区（右侧）
- 实时显示操作日志和结果
- 彩色标记（成功=绿色，错误=红色，信息=蓝色）
- 自动滚动到最新内容

### 4. 状态栏（底部）
- 显示当前操作状态
- 显示实时时间

---

## 功能详解

### Token管理

#### 更新Token（每日必做）
1. 在Token输入框粘贴新的Bearer Token
2. 点击 **💾 保存Token**
3. 系统自动备份旧配置
4. 提示保存成功

#### 测试连接
1. 点击 **✓ 测试连接**
2. 等待验证结果
3. 成功显示绿色提示

---

### 数据爬取与导出

#### 爬取所有数据
1. 点击 **🔍 爬取所有数据**
2. 等待爬取完成（在输出区查看进度）
3. 数据自动保存到 `data/driver_data.json`

#### 查看数据
- **查看司机列表** - 显示前20位司机的详细信息
- **查看车辆列表** - 显示前20辆车的信息
- **查看排班信息** - 显示前20条排班记录

#### 导出数据

**导出为JSON：**
1. 先爬取数据（或已有保存的数据）
2. 点击 **📄 导出为JSON**
3. 选择保存位置和文件名
4. 数据导出为单个JSON文件

**导出为Excel：**
1. 先爬取数据
2. 点击 **📊 导出为Excel**
3. 选择保存位置和文件名
4. 生成Excel文件，包含3个工作表：
   - 司机（司机信息）
   - 车辆（车辆信息）
   - 排班（排班信息）

**打开数据目录：**
- 点击 **📂 打开数据目录**
- 自动打开 `data/` 文件夹
- 查看所有保存的数据文件

---

### 调度操作

#### 派工
1. 点击 **➕ 派工**
2. 在弹出对话框中填写：
   - 司机ID
   - 订单ID
   - 日期（默认今天）
   - 时间段（如 09:00-12:00）
3. 点击 **提交**
4. 查看结果

#### 退工
1. 点击 **➖ 退工**
2. 填写：
   - 订单ID
   - 退工原因（可选）
3. 点击 **提交**

#### 订单转派
1. 点击 **🔄 订单转派**
2. 填写：
   - 订单ID
   - 原司机ID
   - 目标司机ID
   - 日期
   - 转派原因（可选）
3. 点击 **提交**

#### 查看司机订单
1. 点击 **📋 查看司机订单**
2. 输入司机ID和日期
3. 订单列表显示在输出区

---

### 批量操作

#### 批量派工
1. 点击 **📦 批量派工**
2. 在文本框中输入数据，每行一个订单
3. 格式：`司机ID,订单ID,日期,时间段`
4. 示例：
   ```
   123,1001,2025-11-20,09:00-12:00
   124,1002,2025-11-20,13:00-17:00
   125,1003,2025-11-20,18:00-22:00
   ```
5. 点击 **提交**
6. 查看批量处理结果

#### 批量退工
1. 点击 **🗑️ 批量退工**
2. 每行输入一个订单ID
3. 输入退工原因
4. 点击 **提交**

---

## 使用技巧

### 1. 每日工作流程
```
启动程序 → 更新Token → 测试连接 → 爬取数据 → 执行调度操作
```

### 2. 数据备份
- Token保存时自动创建备份文件
- 定期导出数据为Excel/JSON
- 备份文件在项目根目录

### 3. 快捷操作
- **直接双击启动GUI.bat** - 无需打开命令行
- **使用批量操作** - 提高效率
- **随时查看输出区** - 了解操作进度

### 4. 错误处理
- 所有错误都会在输出区用红色显示
- 查看 `automation.log` 获取详细错误信息
- 点击 **📜 查看日志** 在GUI中查看日志

### 5. 数据查看
- 爬取后自动显示数据统计
- 支持查看单项数据（司机/车辆/排班）
- 导出后可用Excel详细分析

---

## 常见问题

### Q1: 程序启动后无反应？
**A:** 检查Python环境，确保安装了所有依赖：
```powershell
pip install -r requirements.txt
```

### Q2: 导出Excel失败？
**A:** 需要安装pandas和openpyxl：
```powershell
pip install pandas openpyxl
```

### Q3: Token保存失败？
**A:** 
- 确保config.py文件存在
- 检查是否有写入权限
- 查看备份文件是否生成

### Q4: 连接测试失败？
**A:**
- 检查Token是否有效
- 确认网络连接正常
- 验证API地址是否正确

### Q5: 数据导出位置在哪？
**A:** 
- 爬取的数据: `data/driver_data.json`
- 导出的文件: 你选择的位置
- 点击 **📂 打开数据目录** 快速访问

---

## 界面截图说明

### Token管理区
```
[Bearer Token: eyJ0eXAi...] [💾保存] [🔄重载] [✓测试]
```

### 功能按钮区
```
┌─ 📊 数据操作 ──────┐
│ 🔍 爬取所有数据     │
│ 👤 查看司机列表     │
│ 🚗 查看车辆列表     │
│ 📅 查看排班信息     │
└────────────────────┘

┌─ 💾 导出数据 ──────┐
│ 📄 导出为JSON      │
│ 📊 导出为Excel     │
│ 📂 打开数据目录     │
└────────────────────┘

... (更多按钮组)
```

### 输出显示区
```
====================================
✓ 数据爬取完成！
  - 司机数量: 50
  - 车辆数量: 45
  - 排班数量: 120
====================================
```

---

## 高级功能

### 1. 自动备份
- Token保存时自动创建带时间戳的备份
- 备份文件格式: `config.backup.YYYYMMDD_HHMMSS.py`

### 2. 多线程操作
- 所有耗时操作在后台线程执行
- GUI界面保持响应
- 实时显示进度

### 3. 日志查看
- 点击 **📜 查看日志** 查看最近100条日志
- 日志文件: `automation.log`
- 包含所有API请求和响应

---

## 键盘快捷键

当前版本暂不支持快捷键，所有操作通过鼠标点击完成。

---

## 技术说明

### 使用的技术
- **GUI框架**: tkinter (Python标准库)
- **数据处理**: json, pandas (可选)
- **API请求**: requests
- **多线程**: threading

### 系统要求
- Python 3.7+
- Windows 10/11
- 网络连接

### 依赖包
```
requests>=2.31.0
pandas>=2.0.0 (可选，用于Excel导出)
openpyxl>=3.1.0 (可选，用于Excel导出)
```

---

## 更新日志

### v1.0.0 (2025-11-20)
- ✅ 首次发布GUI版本
- ✅ 完整的Token管理功能
- ✅ 数据爬取和导出
- ✅ 派工/退工/转派功能
- ✅ 批量操作支持
- ✅ 实时日志显示

---

## 获取帮助

- **完整文档**: 查看 [README.md](README.md)
- **快速入门**: 查看 [快速开始.md](快速开始.md)
- **API参考**: 查看 [API文档.md](API文档.md)

---

**提示**: 记得每天更新Token！使用GUI更方便快捷！
