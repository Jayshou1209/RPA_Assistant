# 快速开始指南

## 1. 安装（首次使用）

### 方法一：使用批处理文件（推荐）
双击运行 `安装依赖.bat`

### 方法二：手动安装
```powershell
pip install -r requirements.txt
```

## 2. 配置Token

编辑 `config.py` 文件，更新以下行：
```python
BEARER_TOKEN = "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
```

## 3. 运行程序

### 方法一：使用批处理文件（推荐）
双击运行 `启动脚本.bat`

### 方法二：命令行运行
```powershell
python main.py
```

### 方法三：运行示例脚本
```powershell
python examples.py
```

## 4. 每日Token更新

### 方法一：使用PowerShell脚本
```powershell
.\update_token.ps1 -NewToken "Bearer 新的Token字符串"
```

### 方法二：直接编辑config.py
打开 `config.py`，替换 `BEARER_TOKEN` 的值

### 方法三：程序内更新
运行主程序后选择菜单 [11] 更新Token

## 5. 常用功能

### 爬取数据
1. 启动程序
2. 选择 [1] 爬取所有数据
3. 数据自动保存到 `data/` 目录

### 派工
1. 选择 [5] 派工（单个）或 [6] 批量派工
2. 输入司机ID、订单ID、日期、时间段
3. 系统自动提交到调度系统

### 退工
1. 选择 [7] 退工（单个）或 [8] 批量退工
2. 输入订单ID和原因
3. 系统自动取消分配

### 订单转派
1. 选择 [9] 订单转派
2. 输入订单ID、原司机ID、目标司机ID
3. 系统自动转派订单

## 6. 故障排查

### 连接失败
- 检查Token是否过期
- 确认网络连接正常
- 查看 `automation.log` 日志

### Token过期
- 每天更新Token（Token有效期24小时）
- 确保Token包含 "Bearer " 前缀

### 导入错误
- 运行 `pip install -r requirements.txt`
- 确认Python版本 3.7+

## 7. 文件说明

| 文件 | 说明 |
|------|------|
| `main.py` | 主程序入口（交互式菜单） |
| `examples.py` | 示例脚本集（编程方式） |
| `config.py` | 配置文件（Token、API地址） |
| `api_client.py` | API客户端模块 |
| `scraper.py` | 数据爬取模块 |
| `dispatcher.py` | 调度功能模块 |
| `update_token.ps1` | Token自动更新脚本 |
| `启动脚本.bat` | 一键启动程序 |
| `安装依赖.bat` | 一键安装依赖 |

## 8. 定时任务设置

### Windows任务计划程序
```powershell
# 每天早上8点自动爬取数据
$action = New-ScheduledTaskAction -Execute "python" -Argument "C:\Users\enjia\OneDrive\桌面\RPA操作助手\main.py"
$trigger = New-ScheduledTaskTrigger -Daily -At 8am
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "RPA数据爬取" -Description "每日爬取调度系统数据"
```

## 9. 技巧提示

- **批量操作**: 使用批量派工/退工可以提高效率
- **数据备份**: 程序自动保存数据到JSON文件
- **日志查看**: 所有操作都记录在 `automation.log` 中
- **示例学习**: 运行 `examples.py` 查看编程用法

## 10. 获取帮助

查看完整文档: `README.md`
查看日志: `automation.log`
运行示例: `python examples.py`

---
**提示**: 记得每天更新Token！
