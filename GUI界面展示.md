# 🎨 GUI界面功能展示

## 界面预览

GUI界面采用专业的布局设计，分为4个主要区域，提供完整的可视化操作体验。

---

## 主界面布局

```
┌─────────────────────────────────────────────────────────────────┐
│ RPA调度系统自动化助手 v1.0                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│  📝 Token管理                                                    │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ Bearer Token: [eyJ0eXAi...           ] [💾保存] [🔄] [✓]  │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                   │
├───────────────┬───────────────────────────────────────────────┤
│               │                                                 │
│ 📊 数据操作   │  📺 输出信息                                   │
│ ┌───────────┐ │  ┌───────────────────────────────────────┐   │
│ │🔍爬取数据 │ │  │ ================================      │   │
│ │👤司机列表 │ │  │ 欢迎使用 RPA调度系统自动化助手       │   │
│ │🚗车辆列表 │ │  │ ================================      │   │
│ │📅排班信息 │ │  │                                        │   │
│ └───────────┘ │  │ [1] 正在爬取数据...                   │   │
│               │  │ ✓ 数据爬取完成！                      │   │
│ 💾 导出数据   │  │   - 司机数量: 50                      │   │
│ ┌───────────┐ │  │   - 车辆数量: 45                      │   │
│ │📄导出JSON │ │  │   - 排班数量: 120                     │   │
│ │📊导出Excel│ │  │                                        │   │
│ │📂打开目录 │ │  │ [2] 正在派工...                       │   │
│ └───────────┘ │  │ ✓ 派工成功！                          │   │
│               │  │                                        │   │
│ 🎯 调度操作   │  │ [3] Token已保存                       │   │
│ ┌───────────┐ │  │                                        │   │
│ │➕ 派工    │ │  │                                        │   │
│ │➖ 退工    │ │  │ (滚动查看更多日志...)                 │   │
│ │🔄 订单转派│ │  │                                        │   │
│ │📋 查看订单│ │  └───────────────────────────────────────┘   │
│ └───────────┘ │                                                 │
│               │                                                 │
│ ⚡ 批量操作   │                                                 │
│ ┌───────────┐ │                                                 │
│ │📦批量派工 │ │                                                 │
│ │🗑️批量退工 │ │                                                 │
│ └───────────┘ │                                                 │
│               │                                                 │
│ ⚙️ 系统       │                                                 │
│ ┌───────────┐ │                                                 │
│ │📜查看日志 │ │                                                 │
│ │🗑️清空输出 │ │                                                 │
│ └───────────┘ │                                                 │
│               │                                                 │
├───────────────┴───────────────────────────────────────────────┤
│ 状态: 就绪                           2025-11-20 14:30:25       │
└─────────────────────────────────────────────────────────────────┘
```

---

## 核心功能展示

### 1. Token管理区

**位置**: 界面顶部  
**功能**:
- 显示当前Token
- 在线编辑Token
- 一键保存到配置文件
- 重新加载配置
- 测试连接状态

**操作流程**:
```
粘贴新Token → 点击"💾 保存Token" → 自动备份 → 提示成功
```

---

### 2. 数据操作区

#### 🔍 爬取所有数据
- 点击后自动获取所有数据
- 后台线程执行，界面不卡顿
- 实时显示进度
- 自动保存到data目录

**输出示例**:
```
====================================
开始爬取所有数据...
====================================
✓ 数据爬取完成！
  - 司机数量: 50
  - 车辆数量: 45
  - 排班数量: 120
  - 数据已保存到: data/driver_data.json
```

#### 👤 查看司机列表
显示前20位司机的详细信息：
```
====================================
司机列表 (共 50 位)
====================================
1. ID:123 | 姓名:张三 | 状态:active
2. ID:124 | 姓名:李四 | 状态:active
...
```

---

### 3. 导出功能

#### 📄 导出为JSON
1. 点击"导出为JSON"
2. 选择保存位置
3. 输入文件名
4. 自动生成JSON文件

**文件内容**:
```json
{
  "timestamp": "2025-11-20T14:30:00",
  "drivers": [...],
  "vehicles": [...],
  "schedules": [...]
}
```

#### 📊 导出为Excel
生成包含3个工作表的Excel文件：
- **司机** - 所有司机信息
- **车辆** - 所有车辆信息  
- **排班** - 所有排班记录

**适用场景**:
- 数据分析
- 报表制作
- 离线查看

#### 📂 打开数据目录
- 一键打开data文件夹
- 查看所有保存的数据文件
- 方便文件管理

---

### 4. 调度操作

#### ➕ 派工对话框

```
┌──────────────────────────┐
│        派工              │
├──────────────────────────┤
│ 司机ID:    [123      ]   │
│ 订单ID:    [456      ]   │
│ 日期:      [2025-11-20]  │
│ 时间段:    [09:00-12:00] │
│                          │
│         [提交]           │
└──────────────────────────┘
```

**操作步骤**:
1. 点击"➕ 派工"
2. 填写表单
3. 点击提交
4. 查看结果

#### ➖ 退工对话框

```
┌──────────────────────────┐
│        退工              │
├──────────────────────────┤
│ 订单ID:    [456      ]   │
│ 退工原因:  [司机请假  ]  │
│                          │
│         [提交]           │
└──────────────────────────┘
```

#### 🔄 订单转派对话框

```
┌──────────────────────────┐
│      订单转派            │
├──────────────────────────┤
│ 订单ID:      [456    ]   │
│ 原司机ID:    [123    ]   │
│ 目标司机ID:  [124    ]   │
│ 日期:        [2025-11-20]│
│ 转派原因:    [调整排班]  │
│                          │
│         [提交]           │
└──────────────────────────┘
```

---

### 5. 批量操作

#### 📦 批量派工窗口

```
┌─────────────────────────────────────┐
│          批量派工                   │
├─────────────────────────────────────┤
│ 输入派工信息 (每行格式: 司机ID,订单ID,日期,时间段)
│                                     │
│ ┌─────────────────────────────────┐│
│ │ # 示例:                         ││
│ │ 123,1001,2025-11-20,09:00-12:00 ││
│ │ 124,1002,2025-11-20,13:00-17:00 ││
│ │ 125,1003,2025-11-20,18:00-22:00 ││
│ │                                 ││
│ │ (可输入多行...)                 ││
│ └─────────────────────────────────┘│
│                                     │
│            [提交]                   │
└─────────────────────────────────────┘
```

**处理结果**:
```
开始批量派工 (3 个订单)...
  [1/3] 派工订单 1001 → 司机 123
  [2/3] 派工订单 1002 → 司机 124
  [3/3] 派工订单 1003 → 司机 125
✓ 批量派工完成: 3/3 成功
```

---

## 实时日志显示

输出区域使用彩色标记：
- **绿色** = 成功操作 ✓
- **红色** = 错误信息 ✗
- **蓝色** = 普通信息
- **橙色** = 警告信息

**示例输出**:
```
====================================
✓ API客户端初始化成功
====================================
正在爬取数据...
  ✓ 获取司机数据: 50 位
  ✓ 获取车辆数据: 45 辆
  ✓ 获取排班数据: 120 条
✓ 数据已保存

====================================
开始派工...
  司机ID: 123
  订单ID: 456
  日期: 2025-11-20
✓ 派工成功！

====================================
✓ Token已保存
  备份文件: config.backup.20251120_143000.py
```

---

## 状态栏

**左侧**: 当前操作状态
- "就绪" - 等待操作
- "正在爬取数据..." - 执行中
- "正在派工..." - 处理中

**右侧**: 实时时间
- 格式: YYYY-MM-DD HH:MM:SS
- 每秒自动更新

---

## 对话框样式

所有对话框采用统一设计：
1. **模态窗口** - 弹出时禁用主窗口
2. **居中显示** - 自动居中对齐
3. **输入验证** - 防止错误输入
4. **友好提示** - 清晰的操作说明

---

## 多线程处理

所有耗时操作都在后台线程执行：
- 数据爬取
- API请求
- 文件导出

**优势**:
- GUI保持响应
- 可以中途操作其他功能
- 实时查看进度

---

## 错误处理

GUI提供完善的错误处理：

### 成功提示框
```
┌──────────────────┐
│   ✓ 成功         │
├──────────────────┤
│ 派工成功！       │
│                  │
│      [确定]      │
└──────────────────┘
```

### 错误提示框
```
┌──────────────────┐
│   ✗ 错误         │
├──────────────────┤
│ 连接失败         │
│ 请检查Token      │
│                  │
│      [确定]      │
└──────────────────┘
```

### 警告提示框
```
┌──────────────────┐
│   ⚠ 警告         │
├──────────────────┤
│ 请先爬取数据     │
│                  │
│      [确定]      │
└──────────────────┘
```

---

## 快捷操作流程

### 每日工作流程
```
1. 双击 "启动GUI.bat"
2. 更新Token（在输入框中）
3. 点击 "💾 保存Token"
4. 点击 "✓ 测试连接"
5. 点击 "🔍 爬取所有数据"
6. 执行调度操作（派工/退工/转派）
7. 需要时导出数据
```

### 快速派工
```
点击 "➕ 派工" → 填写表单 → 提交 → 完成
（约10秒）
```

### 快速导出
```
点击 "📊 导出为Excel" → 选择位置 → 保存 → 完成
（约5秒）
```

---

## 使用技巧

### 1. 键盘操作
- Tab键切换输入框
- Enter键提交表单
- Esc键关闭对话框

### 2. 鼠标操作
- 双击选中文本
- 右键复制/粘贴（在输入框中）
- 滚轮滚动输出区

### 3. 数据管理
- 定期导出数据备份
- 使用Excel分析数据
- 保存重要日志

### 4. 效率提升
- 使用批量操作
- 提前准备数据（CSV/Excel）
- 复制粘贴批量输入

---

## 系统要求

- **操作系统**: Windows 10/11
- **Python**: 3.7+
- **内存**: 建议2GB+
- **屏幕分辨率**: 1280x800 或更高

---

## 注意事项

1. **Token安全**
   - 不要截图包含Token的界面
   - 定期更换Token
   - 关闭窗口时Token仍在内存中

2. **数据备份**
   - 导出重要数据
   - Token保存自动备份
   - 定期清理旧备份

3. **性能优化**
   - 大量数据建议分批处理
   - 定期清空输出区
   - 关闭不用的对话框

---

## 相关文档

- **详细教程**: [GUI使用指南.md](GUI使用指南.md)
- **完整文档**: [README.md](README.md)
- **快速开始**: [快速开始.md](快速开始.md)

---

**最后更新**: 2025-11-20  
**版本**: 1.0.0
