# RPA助手打包说明

## 当前项目结构

核心文件：
- `gui.py` - 主程序GUI界面
- `api_client.py` - API客户端
- `scraper.py` - 数据爬取器
- `dispatcher.py` - 派工调度器
- `enhanced_scraper.py` - 增强爬取器
- `real_api_scraper.py` - 真实API爬取器
- `config.py` - 配置文件
- `token.txt` - API令牌
- `requirements.txt` - 依赖包列表
- `启动GUI.bat` - 快速启动脚本
- `安装依赖.bat` - 依赖安装脚本

## 打包步骤

### 1. 确保已安装PyInstaller
```bash
py -m pip install pyinstaller
```

### 2. 使用PyInstaller打包（推荐方式）
```bash
pyinstaller --onefile --windowed --name="RPA调度助手" --hidden-import=api_client --hidden-import=scraper --hidden-import=dispatcher --hidden-import=enhanced_scraper --hidden-import=real_api_scraper --add-data="config.example.py;." --add-data="token.txt;." gui.py
```

参数说明：
- `--onefile`: 打包成单个exe文件
- `--windowed`: 无控制台窗口（GUI程序）
- `--name`: 指定生成的exe名称
- `--hidden-import`: 确保所有依赖模块被打包
- `--add-data`: 包含配置文件和token文件

### 3. 简化打包（带控制台调试）
```bash
pyinstaller --onefile --name="RPA调度助手" --hidden-import=api_client --hidden-import=scraper --hidden-import=dispatcher --hidden-import=enhanced_scraper --hidden-import=real_api_scraper gui.py
```

### 4. 打包后文件位置
- 生成的exe文件在 `dist` 文件夹中
- 第一次运行时需要确保 `config.py` 和 `token.txt` 在同一目录

## 使用说明

### 方式1：直接运行Python（开发模式）
双击 `启动GUI.bat`

### 方式2：运行打包的exe（发布模式）
1. 打包后复制 `dist\RPA调度助手.exe` 到目标位置
2. 在同一目录下放置 `config.py` 和 `token.txt`
3. 创建 `data` 文件夹用于存放账单
4. 双击exe运行

## 注意事项

1. **首次使用需要配置**：
   - 复制 `config.example.py` 为 `config.py`
   - 在 `token.txt` 中填入有效的API令牌

2. **打包后目录结构**：
   ```
   RPA调度助手.exe
   config.py
   token.txt
   data/
   ```

3. **如果打包失败**，尝试删除以下文件夹后重新打包：
   - `build/`
   - `dist/`
   - `*.spec`

4. **依赖包**：确保已安装所有依赖
   ```bash
   py -m pip install -r requirements.txt
   ```
